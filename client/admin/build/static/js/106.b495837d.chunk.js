(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{1294:function(e,t,a){"use strict";a.r(t);var n=a(13),i=a.n(n),s=a(34),r=a(17),l=a(18),o=a(21),c=a(19),u=a(20),p=a(0),m=a.n(p),f=a(620),d=a(622),v=a(14),h=a(627),g=a(621),b=a(623),E=a(45),S=a(637),w=a.n(S),x=(a(633),a(25)),y=a.n(x),C=(a(696),a(35)),O=(a(642),a(743),f.a.Item),F=d.a.TextArea,N=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={title:"ss",desc:"qq",icon:"",content:"",fileList:[],removedFile:[],fileName:"",disable:!1},a.componentDidMount=Object(s.a)(i.a.mark(function e(){var t,n,s,r,l,o,c,u,p;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,e.next=3,y()("/api/v2/core/".concat(t));case 3:if(n=e.sent,s=n.data,r=s[0],l=r.title,o=r.desc,c=r.icon,u=r.body,p=[],""===c){e.next=10;break}return e.next=10,y.a.get("/api/v2/files/getFile/".concat(c)).then(function(e){return p.push({uid:w()(),name:"image.png",status:"done",url:"/api/v2/files/getFile/".concat(c)})}).catch(function(e){});case 10:a.setState({title:l,desc:o,icon:c,content:u,fileList:p});case 11:case"end":return e.stop()}},e)})),a.handleEditorChange=function(e){var t=e.target.getContent();a.setState(function(){return{content:t}})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll(function(e,t){if(!e){a.setState({disable:!0});var n=a.state,r=(n.icon,n.content),l=n.removedFile,o=n.fileList,c=n.fileName;""!==c&&(t.icon=c),t.body=r;var u=a.props.match.params.id;o.length?y.a.post("/api/v2/core/updateCore",{data:t,params:{id:u}}).then(function(e){var t=e.data.message,n=e.statusText;200===e.status?a.setState({loading:!1},function(){C.NotificationManager.success(t,"SUCCESS",2e3),setTimeout(function(){a.props.history.push("/admin/core/viewcore"),a.setState({disable:!1})},3e3),l.length&&l.map(function(){var e=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/v2/files/removeFile",{pic:t});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}):a.setState({loading:!1},function(){C.NotificationManager.error(t||n,"ERROR",2e3),setTimeout(function(){a.setState({disable:!1})},2e3)})}).catch(function(e){a.setState({loading:!1},function(){var t=e.response,n=t.data.message,i=t.statusText;C.NotificationManager.error(n||i,"ERRRO",2e3),setTimeout(function(){a.setState({disable:!1})},2e3)})}):(C.NotificationManager.error("Please Choose an image !","ERROR",2e3),setTimeout(function(){a.setState({disable:!1})},2e3))}})},a.showPickedIcon=function(e){var t=e.name;a.setState({icon:t})},a.handlePreview=function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},a.removeFile=function(){var e=Object(s.a)(i.a.mark(function e(t){var n,s,r,l,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.removedFile,(s=t.url)?(r=s.split("/"),l=r[r.length-1],n.push(l)):(o=t.response.fullName,n.push(o)),a.setState({removedFile:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){var t=e.file,n=e.fileList;if(a.setState({fileList:n}),n.length){var i=t.status,s="image/svg+xml"===t.type,r="image/png"===t.type;if(s||r){if("done"===i){var l=t.response.fullName;a.setState({fileName:l})}}else a.setState({fileList:n}),C.NotificationManager.error("You can only upload svg files!","ERROR",2e3),a.setState(function(){return{fileList:[]}})}},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.title,n=t.desc,i=t.icon,s=(t.content,t.fileList),r=t.previewVisible,l=t.disable,o=m.a.createElement("div",null,m.a.createElement(v.a,{type:"plus"}),m.a.createElement("div",{className:"ant-upload-text"},"Upload")),c={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}};return m.a.createElement(h.a,{className:"gx-card",title:"Edit Core"},m.a.createElement(f.a,{onSubmit:this.handleSubmit},m.a.createElement(O,Object.assign({},c,{label:m.a.createElement("span",null,"Icon")}),m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{action:"/api/v2/files/uploadFile",listType:"picture-card",fileList:s,onPreview:this.handlePreview,onChange:this.handleChange,onRemove:this.removeFile,accept:"image/png, image/svg+xml"},1===s.length?null:o),m.a.createElement(b.a,{visible:r,footer:null,onCancel:this.handleCancel},m.a.createElement("img",{alt:"example",style:{width:"100%"},src:"/api/v2/files/getFile/".concat(i)})))),m.a.createElement(O,Object.assign({},c,{label:m.a.createElement("span",null,"Title")}),e("title",{initialValue:a||null,rules:[{max:30,message:"Max is 30 letter"}]})(m.a.createElement(d.a,null))),m.a.createElement(O,Object.assign({},c,{label:m.a.createElement("span",null,"Description")}),e("desc",{initialValue:n||null,rules:[{max:150,message:"Max is 150 letter"}]})(m.a.createElement(F,null))),m.a.createElement(O,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},l?m.a.createElement(E.a,{type:"primary",disabled:!0,htmlType:"submit"},"Save"):m.a.createElement(E.a,{type:"primary",htmlType:"submit"},"Save"))),m.a.createElement(C.NotificationContainer,null))}}]),t}(p.Component),R=f.a.create()(N);t.default=R}}]);
//# sourceMappingURL=106.b495837d.chunk.js.map