(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{1310:function(e,t,a){"use strict";a.r(t);var n=a(647),i=a(13),r=a.n(i),l=a(34),s=a(17),o=a(18),c=a(21),u=a(19),p=a(20),m=a(187),h=a(0),d=a.n(h),f=a(22),g=a(620),v=a(607),b=a(622),E=a(14),w=a(627),y=a(69),C=a(621),k=a(623),S=a(661),O=a(606),j=a(1356),x=a(45),P=(a(633),a(25)),N=a.n(P),R=a(35),F=a(642),I=a(112),_=a.n(I),D=g.a.Item,L=v.a.Option,V=b.a.TextArea,T=function(e){function t(){var e,a;Object(s.a)(this,t);for(var i=arguments.length,o=new Array(i),p=0;p<i;p++)o[p]=arguments[p];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={confirmDirty:!1,autoCompleteResult:[],fileList:[],previewVisible:!1,previewImage:"",tags:[],inputVisible:!1,categories:[],fileName:"",content:"",removedFile:[],heroLength:"",inputValue:"",mode:"time",breaking:!1},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handleOpenChange=function(e){e&&a.setState({mode:"time"})},a.onChangeCheckBreaking=function(e){var t=e.target.checked;a.setState(function(){return{breaking:t}})},a.handlePanelChange=function(e,t){a.setState({mode:t})},a.componentDidMount=Object(l.a)(r.a.mark(function e(){var t,n,i,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.get("/api/v2/categories");case 2:return t=e.sent,e.next=5,N.a.get("/api/v2/heading");case 5:n=e.sent,i=n.data,l=t.data,a.setState({categories:l,heroLength:i.length});case 9:case"end":return e.stop()}},e)})),a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll(function(e,t){if(!e){var n=a.state,i=n.fileList,s=n.removedFile,o=n.tags,c=[];if(i.map(function(e){return c.push(e.response.fullName),c}),0!==c.length){var u=a.state.content;u.trim()?(t.description=u,t.header_media=c,t.tags=o,N.a.post("/api/v2/post",t).then(function(e){var n=e.data.message;t.newsLetter?R.NotificationManager.success("Post has been added, redirect to email list","SUCCESS",2e3):(R.NotificationManager.success(n,"SUCCESS",2e3),setTimeout(function(){a.props.history.push("/admin/Posts/viewPosts/all")},3e3)),s.length&&s.map(function(){var e=Object(l.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.post("/api/v2/files/removeFile",{pic:t});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}).catch(function(){var e=Object(l.a)(r.a.mark(function e(t){var a,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.response,n=a.data.message,i=a.statusText,R.NotificationManager.error(n||i,"ERROR",2e3);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())):R.NotificationManager.error("Please Add details for the post","ERROR",2e3)}else R.NotificationManager.error("Please Choose image or video !","ERROR",2e3)}})},a.handleConfirmBlur=function(e){var t=e.target.value;a.setState({confirmDirty:a.state.confirmDirty||!!t})},a.compareToFirstPassword=function(e,t,n){var i=a.props.form;t&&t!==i.getFieldValue("password")?n("Two passwords that you enter is inconsistent!"):n()},a.validateToNextPassword=function(e,t,n){var i=a.props.form;t&&a.state.confirmDirty&&i.validateFields(["confirm"],{force:!0}),n()},a.handleWebsiteChange=function(e){var t;t=e?[".com",".org",".net"].map(function(t){return"".concat(e).concat(t)}):[],a.setState({autoCompleteResult:t})},a.handleEditorChange=function(e){var t=e.target.getContent();a.setState(function(){return{content:t}})},a.onEditorStateChange=function(e){a.setState({editorState:e})},a.handlePreview=function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},a.removeFile=function(){var e=Object(l.a)(r.a.mark(function e(t){var n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.removedFile,i=t.response.fullName,n.push(i),a.setState({removedFile:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){var t=e.file,n=e.fileList,i="image/jpeg"===t.type,r="image/png"===t.type,l=t.size/1024/1024<2;if(i||r)if(l){if(a.setState({fileList:n}),"done"===t.status){var s=t.response.fullName;a.setState({fileName:s})}}else R.NotificationManager.error("Image must smaller than 2MB!","ERROR",2e3);else R.NotificationManager.error("You can only upload image files!","ERROR",2e3)},a.showInput=function(){a.setState({inputVisible:!0},function(){return a.input.focus()})},a.handleClose=function(e){var t=a.state.tags.filter(function(t){return t!==e});a.setState({tags:t})},a.saveInputRef=function(e){return a.input=e},a.handleInputChange=function(e){a.setState({inputValue:e.target.value})},a.handleInputConfirm=function(){var e=Object(m.a)(Object(m.a)(a)).state,t=e.inputValue,i=e.tags;t&&-1===i.indexOf(t)&&(i=[].concat(Object(n.a)(i),[t])),a.setState({tags:i,inputVisible:!1,inputValue:""})},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"updateContent",value:function(e){this.setState({content:e})}},{key:"editorChange",value:function(e){var t=e.editor.getData();this.setState({content:t})}},{key:"onBlur",value:function(e){}},{key:"afterPaste",value:function(e){}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props.role,n=this.state,i=n.previewVisible,r=n.fileList,l=n.previewImage,s=n.categories,o=n.heroLength,c=n.tags,u=n.inputVisible,p=n.inputValue,m=n.breaking,h=d.a.createElement("div",null,d.a.createElement(E.a,{type:"plus"}),d.a.createElement("div",{className:"ant-upload-text"},"Upload")),f={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}};return d.a.createElement(w.a,{className:"gx-card",title:"Add Post"},d.a.createElement(g.a,{onSubmit:this.handleSubmit},d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Title\xa0",d.a.createElement(y.a,{title:"What is the title of the post"},d.a.createElement(E.a,{type:"question-circle-o"})))}),t("title",{rules:[{required:!0,message:"Please input your title!",whitespace:!0}]})(d.a.createElement(b.a,null))),d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Seo name")}),t("seo",{rules:[{required:!0,message:"Please input your seo!",whitespace:!0},{max:20,message:"Max Letters for Seo is 20",whitespace:!0}]})(d.a.createElement(b.a,null))),d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Post Introduction")}),t("post_intro",{rules:[{required:!0,message:"Please input your intro!",whitespace:!0},{max:260,message:"Max Letters for Intro is 260",whitespace:!0}]})(d.a.createElement(V,{rows:4}))),d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Category")}),t("category",{rules:[{required:!0,message:"Please input category name!",whitespace:!0}]})(d.a.createElement(v.a,null,s.length&&s.map(function(e){return d.a.createElement(L,{key:e.id,value:"".concat(e.id)},e.name)})))),d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Upload Header Photo")}),d.a.createElement(d.a.Fragment,null,d.a.createElement(C.a,{action:"/api/v2/files/uploadFile",listType:"picture-card",fileList:r,onPreview:this.handlePreview,onChange:this.handleChange,onRemove:this.removeFile},r.length>=5?null:h),d.a.createElement(k.a,{visible:i,footer:null,onCancel:this.handleCancel},d.a.createElement("img",{alt:"example",style:{width:"100%"},src:l}))),","),d.a.createElement(D,Object.assign({},f,{label:"Meta tags"}),d.a.createElement("div",null,c.map(function(t,a){var n=t.length>20,i=d.a.createElement(S.a,{key:t,closable:!0,afterClose:function(){return e.handleClose(t)}},n?"".concat(t.slice(0,20),"..."):t);return n?d.a.createElement(y.a,{title:t,key:t},i):i}),u&&d.a.createElement(b.a,{ref:this.saveInputRef,type:"text",size:"small",style:{width:78},value:p,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!u&&d.a.createElement(S.a,{onClick:this.showInput,style:{background:"#fff",borderStyle:"dashed"}},d.a.createElement(E.a,{type:"plus"})," New Tag"))),d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Description")}),d.a.createElement(F.a,{init:{images_upload_url:"/api/v2/files/uploadFile",images_upload_base_path:"/api/v2/files/uploadFile",image_caption:!0,images_upload_handler:function(e,t,a){var n=new FormData;n.append("file",e.blob()),N.a.post("/api/v2/files/uploadFile",n).then(function(e){var a=e.data.fullName;t("/api/v2/files/getFile/".concat(a))}).catch(function(e){a("error !")})},height:700,image_title:!0,automatic_uploads:!0,file_picker_types:"file image media",images_upload_credentials:!0,plugins:"print preview fullpage powerpaste searchreplace autolink directionality advcode visualblocks visualchars fullscreen image link media mediaembed template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount tinymcespellchecker a11ychecker imagetools textpattern help formatpainter permanentpen pageembed mentions linkchecker",toolbar:"formatselect | bold italic strikethrough forecolor backcolor permanentpen formatpainter | link image media pageembed | alignleft aligncenter alignright alignjustify  | numlist bullist outdent indent | removeformat | addcomment"},onChange:this.handleEditorChange}),","),"admin"===a?o<4?d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Hero Section")}),t("hero")(d.a.createElement(O.a,null,"Do you want to view this post in the hero section"))):d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Hero Section")}),d.a.createElement("span",{style:{color:"red"}},"You can only put 4 posts in Hero Section")):null,d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"Breaking News")}),t("breaking")(d.a.createElement(O.a,{onChange:this.onChangeCheckBreaking},"Do you want to consider this post as a breaking news ?"))),m?d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"End Date/Time")}),t("breakingEnd")(d.a.createElement(j.a,{mode:this.state.mode,showTime:!0,onOpenChange:this.handleOpenChange,onPanelChange:this.handlePanelChange,disabledDate:function(e){return e<_()().endOf("tommorow")}}))):null,d.a.createElement(D,Object.assign({},f,{label:d.a.createElement("span",null,"News Letter")}),t("newsLetter")(d.a.createElement(O.a,null,"Send This news to mail list"))),d.a.createElement(D,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},d.a.createElement(x.a,{type:"primary",htmlType:"submit"},"Add Post"))),d.a.createElement(R.NotificationContainer,null))}}]),t}(h.Component),M=g.a.create()(T);t.default=Object(f.b)(function(e){var t=e.auth;return{authUser:t.authUser,url:t.url,role:t.role}})(M)}}]);
//# sourceMappingURL=90.a4f1fc0c.chunk.js.map